# OpenStreetMap Carto DE setup instructions

The database we use in German Carto style uses a slighty different
table layout which is able to render localized maps.

Thus if you want to create indexes you will also need to apply
``indexes-hstore.sql`` instead of indexes.sql.

To do the actual rendering we use views which will also allow for rendering
the unmodified upstream OpenStreetMap Carto style.

For this purpose we do also provide a branch called upstream+l10n which are
localization only changes to Openstreetmap Carto.

Master branch will do localization **and** other visual German style changes.

For database import, the localization code from
https://github.com/giggls/osml10n and osm2pgsql 1.7.0 or higher are
required.

The import command looks like this:

```
osm2pgsql -O flex -d osm -S openstreetmap-carto-hstore-only-l10n.lua planet-latest.osm.pbf
```

See osml10n installation instructions for details.

If you want to change the target langugage from German to another language
using latin script change the 'lang' variable in
openstreetmap-carto-hstore-only-l10n.lua fron 'de' to your desired language
('en', 'fr', 'es', ..).

The database layout of the git master branch is aiming to be compatible witch
openstreetmap-carto 5.x

The actual rendering is done using database views providing virtual columns
instead of using the tables generated by osm2pgsql. These views have to
be created after the initial osm2pgsql data import using the provided SQL
files as follows:

```
psql -d osm -f views_osmde/view-line.sql
psql -d osm -f views_osmde/view-point.sql
psql -d osm -f views_osmde/view-polygon.sql
psql -d osm -f views_osmde/view-roads.sql
```

For convenience reasons you can also use the provided shell-script for
the generation of the views as follows:

```
./views_osmde/apply-views.sh osm

```

For compatibility reasons, the views are given the same name as the default
osm2pgsql tables used in upstream Openstreetmap Carto style!

Since upstream version v5.9.0 carto it bis also necessary to apply ```functions.sql```:

```
psql -d osm -f functions.sql
```

Thus an unmodified version of the upstream style will also work fine using this
slightly different database layout.

The style is currently developed using Debian GNU/Linux 12.

To actually use this style you need to generate ```osm-de.xml``` from ```project.mml```.
The easiest way to do this is using ```make```!

It is also possible to use [Magnacarto](https://github.com/omniscale/magnacarto) or
[Kosmtik](https://github.com/kosmtik/kosmtik).
Both projects can use ```project.mml``` directly.
